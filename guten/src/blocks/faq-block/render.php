<?php
/**
 * FAQ-Block Block render template.
 *
 * @package domca
 */

$domca_faq_block_title = $attributes['title'] ?? '';
$domca_faq_block_items = $attributes['items'] ?? array();

$domca_faq_block_wrapper_attributes = get_block_wrapper_attributes(
	array(
		'class' => 'dm-wrap',
	)
);

$domca_faq_block_base_class = 'wp-block-domca-faq-block';

$domca_faq_block_render_decor_svg = static function () use ( $domca_faq_block_base_class ) {
	ob_start();
	?>
	<svg
			preserveAspectRatio="none"
			aria-hidden="true"
			viewBox="0 0 1441 134"
			fill="none"
			class="<?php echo esc_attr( "{$domca_faq_block_base_class}__item-decor" ); ?>"
	>
		<path
				d="M2 41C2 21.67 17.67 6 37 6H1401C1420.33 6 1436 21.67 1436 41V93C1436 112.33 1420.33 128 1401 128H37C17.6701 128 2 112.33 2 93V41Z"
			  fill="white"
		/>
		<path
				d="M1217.46 131.721C1150.09 130.923 1097.06 134.45 1014.96 133.952C932.855 133.453 920.559 131.582 826.528 132.003C732.503 132.424 638.424 131.145 596.557 131.913C554.692 132.682 550.273 130.358 490.821 130.874C431.371 131.39 395.34 131.087 343.347 130.331C291.35 129.576 131.61 128.931 73.5235 129.859C61.5936 130.049 49.3193 130.133 37 130.142C16.804 130.685 -0.648724 111.931 0.21246 93C0.437522 74.2288 0.726787 56.4909 0.948014 41C1.03827 33.2952 3.62948 26.3344 7.26886 21.0609C14.6083 10.497 24.9568 6.73735 32.3276 5.9628C35.519 5.6382 37.0003 5.9001 37 6.02704C37 6.02714 37 6.02724 37 6.02733C36.9955 6.24216 34.7256 6.25822 30.7568 6.97889C18.7372 8.71158 2.58023 21.3406 2.90776 41C3.06188 52.0453 3.25592 64.0062 3.49869 76.672C3.61143 82.5536 3.70275 87.9622 3.77606 93C4.9154 114.99 21.433 125.822 37 126.017C57.9798 126.126 81.7658 126.313 125.926 125.991C213.894 125.349 266.747 124.066 370.252 124.896C473.757 125.725 497.531 122.254 643.638 124.221C789.742 126.188 805.12 122.558 950.717 122.075C1096.32 121.593 1280.11 123.596 1367.87 123.43C1378.49 123.409 1389.55 123.386 1401 123.36C1416.27 123.805 1431.6 109.959 1431.24 93C1431.2 76.2301 1431.17 58.8638 1431.15 41C1431.56 25.4173 1417.47 10.5367 1401 10.9002C1357.72 10.912 1312.32 10.8586 1266.01 10.6803C1141.59 10.2012 987.992 11.4107 850.648 10.5558C713.306 9.701 519.133 8.62133 429.428 7.89786C339.726 7.17441 317.862 7.01123 231.519 7.45328C181.888 7.70739 113.517 7.46787 55.766 6.53336C26.7019 6.06305 33.2878 5.40821 62.5419 5.09489C105.321 4.63673 140.438 4.94281 162.48 4.12443C206.525 2.48886 225.244 1.86143 280.848 2.81339C336.448 3.76524 362.647 1.60201 395.059 1.85099C427.473 2.10009 426.939 3.37605 591.745 2.39298C756.554 1.40987 846.902 1.15902 909.314 0.923011C971.726 0.686997 1102.05 1.7944 1203.76 1.39469C1253.36 1.19981 1327.93 1.18704 1401 1.14926C1422.59 0.62778 1441.46 20.2413 1440.89 41C1440.9 59.0169 1440.93 76.4971 1440.96 93C1441.31 116.665 1419.74 133.821 1401 133.108C1388.76 133.158 1377.76 133.219 1368.34 133.293C1284.99 133.947 1284.81 132.519 1217.46 131.721Z"
			  fill="#967376"
		/>
	</svg>
	<?php
	return (string) ob_get_clean();
}
?>

<section
		<?php
        // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped
		echo $domca_faq_block_wrapper_attributes;
		?>
>
	<div class="<?php echo esc_attr( $domca_faq_block_base_class . '__wrap dm-container' ); ?>">
		<?php if ( ! empty( $domca_faq_block_title ) ) : ?>
			<h2 class="<?php echo esc_attr( $domca_faq_block_base_class . '__title dm-heading dm-heading-h2' ); ?>">
				<?php echo wp_kses_post( $domca_faq_block_title ); ?>
			</h2>
		<?php endif; ?>

		<?php if ( ! empty( $domca_faq_block_items ) ) : ?>
			<div class="<?php echo esc_attr( $domca_faq_block_base_class . '__items' ); ?>">
				<?php
				$domca_faq_block_items_idx = 1;

				foreach ( $domca_faq_block_items as $domca_faq_block_item ) :
					$domca_faq_block_item_title  = $domca_faq_block_item['question'] ?? '';
					$domca_faq_block_item_answer = $domca_faq_block_item['answer'] ?? '';
					?>
					<div class="<?php echo esc_attr( $domca_faq_block_base_class . '__item' ); ?>">
						<?php
                        // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped
						echo $domca_faq_block_render_decor_svg();
						?>
						<div class="<?php echo esc_attr( $domca_faq_block_base_class . '__question' ); ?>">
							<span class="<?php echo esc_attr( $domca_faq_block_base_class . '__question_text' ); ?>">
								<?php echo wp_kses_post( $domca_faq_block_items_idx . '. ' . $domca_faq_block_item_title ); ?>
							</span>
							<svg width="34" height="34" viewBox="0 0 34 34" fill="none">
								<path
										d="M21.2947 16.5589C20.9552 15.5612 18.9742 16.4895 18.3649 15.469C17.7556 14.4485 18.4052 13.5548 17.2983 12.7952C16.1915 12.0355 15.7855 10.574 15.053 10.4755C14.3203 10.3771 15.2352 9.37449 14.4322 8.99736C13.6292 8.62022 13.3968 8.13746 13.1924 7.30978C12.9879 6.48207 11.6685 4.63056 10.7092 4.43687C9.74981 4.24317 9.75651 2.92137 9.5186 2.36838C9.4445 2.19613 9.41472 2.03204 9.41027 1.88786C9.40842 1.82675 9.45585 1.75023 9.51701 1.68904C9.51705 1.689 9.51709 1.68896 9.51713 1.68892C9.59332 1.61276 9.69076 1.56041 9.74085 1.59125C9.98397 1.74094 10.4008 1.91122 11.0238 1.98176C12.1854 2.11326 11.6869 2.7531 12.8247 3.36154C13.9625 3.96997 15.0162 3.96539 15.7013 5.33488C16.3865 6.70432 18.0543 5.50844 18.693 7.77005C19.3317 10.0316 20.9818 8.68673 22.626 9.9327C24.2702 11.1787 25.2681 13.8291 26.2078 14.6317C26.268 14.6831 26.3298 14.7353 26.3932 14.7884L28.1627 17.2491L26.4315 18.5484C25.6753 19.4892 24.7428 20.7484 23.4222 21.7464C22.0111 22.8127 21.0269 24.8566 19.3322 25.9019C17.6374 26.9473 15.2956 28.4772 14.1191 29.0933C12.9427 29.7093 12.6615 29.8648 12.0083 30.9177C11.6328 31.5229 10.8673 32.1184 9.91272 32.3256C9.43229 32.4299 9.22074 32.0987 9.37326 31.6759C9.5963 31.0577 10.0665 30.8257 9.93634 30.2719C9.67622 29.1652 9.59416 28.7222 10.5353 28.5438C11.4763 28.3653 10.8206 27.2261 11.2405 26.9985C11.6604 26.7709 12.1921 27.2918 13.3805 25.2259C14.5688 23.1599 15.3415 22.1438 15.8489 21.4165C16.3562 20.6892 18.089 19.8169 18.9096 18.6255C19.6795 17.5076 21.6326 15.7253 22.3125 14.594L22.3556 18.8259C22.2822 18.7798 22.2115 18.7391 22.1439 18.7048C21.0467 18.1474 21.6341 17.5566 21.2947 16.5589Z"
										fill="#967376"/>
							</svg>
						</div>
						<div class="<?php echo esc_attr( $domca_faq_block_base_class . '__answer' ); ?>">
							<div class="<?php echo esc_attr( $domca_faq_block_base_class . '__answer_text' ); ?>">
								<?php echo wp_kses_post( $domca_faq_block_item_answer ); ?>
							</div>
						</div>
					</div>
					<?php
					$domca_faq_block_items_idx ++;
				endforeach;
				?>
			</div>
		<?php endif; ?>
	</div>
</section>
