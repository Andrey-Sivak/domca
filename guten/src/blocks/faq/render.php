<?php
/**
 * FAQ Block render template.
 *
 * @package domca
 */

$domca_faq_items = $attributes['items'] ?? array();
$domca_faq_title = $attributes['title'] ?? '';

$domca_faq_base_class = 'wp-block-domca-faq';

$domca_faq_wrapper_attributes = get_block_wrapper_attributes();

$domca_faq_item_bg = '<svg viewBox="0 0 466 165" fill="none" class="' . esc_attr( $domca_faq_base_class . '__item_decor' ) . '" preserveAspectRatio="none" aria-hidden="true">
<path d="M3 46C3 23.9086 20.9086 6 43 6H421C443.091 6 461 23.9086 461 46V119C461 141.091 443.091 159 421 159H43C20.9086 159 3 141.091 3 119V46Z" fill="white"/>
<path d="M351.637 162.721C326.181 161.923 306.141 165.45 275.113 164.952C244.086 164.453 239.439 162.582 203.904 163.003C168.371 163.424 132.818 162.145 116.996 162.913C101.175 163.682 99.5056 161.358 77.0382 161.874C63.5836 162.183 53.303 162.198 43 161.998C35.6008 161.849 28.1559 159.82 21.1482 155.262C13.7454 150.916 0.993369 137.25 1.46096 119C1.68845 96.0459 1.67417 70.7774 1.14127 58.1737C0.972898 54.1913 0.88807 50.1074 0.864299 46C0.255191 25.5251 18.0387 10.1053 30.0053 7.31903C34.5885 5.91517 38.3841 5.6554 41.2313 5.69473C42.4388 5.7174 43.0007 5.88134 43 6.02704C43 6.02714 43 6.02724 43 6.02733C42.9981 6.21569 42.1413 6.37691 40.6247 6.48699C33.3713 6.9035 21.832 10.5419 13.9113 20.7761C6.47391 30.9877 5.38043 37.9328 4.95993 46C4.85135 53.5535 4.70891 62.4196 5.00919 77.9768C5.30755 93.4342 5.74453 106.022 6.04332 119C6.40353 132.476 13.9896 147.971 32.5107 154.384C36.1592 155.554 39.6931 156.023 43 156.026C73.0169 156.05 85.433 153.463 134.789 155.221C190.002 157.188 195.814 153.558 250.836 153.075C305.858 152.593 375.314 154.596 408.482 154.43C412.493 154.409 416.671 154.386 421 154.36C437.428 154.964 456.428 139.776 456.099 119C456.092 103.136 456.147 86.536 456.32 69.6163C456.397 62.0086 456.43 54.1122 456.436 46C457.063 28.0346 440.401 10.2196 421 10.8054C397.279 10.9085 373.288 10.9314 350.482 10.5558C298.58 9.701 225.201 8.62133 191.301 7.89786C157.402 7.17441 149.139 7.01123 116.51 7.45328C97.7541 7.70739 71.9163 7.46787 50.0918 6.53336C39.1083 6.06305 41.5971 5.40821 52.6524 5.09489C68.8188 4.63673 82.0897 4.94281 90.4196 4.12443C107.064 2.48886 114.139 1.86143 135.151 2.81339C156.163 3.76524 166.064 1.60201 178.313 1.85099C190.562 2.10009 190.36 3.37605 252.641 2.39298C314.923 1.40987 349.067 1.15902 372.652 0.923011C384.107 0.808383 401.616 1.01065 421 1.20324C444.658 0.462444 466.466 23.5189 465.604 46C465.605 46.0304 465.605 46.0607 465.605 46.0911C465.796 64.4653 465.812 91.912 465.849 119C466.551 146.344 439.789 165.33 421 164.108C416.373 164.158 412.218 164.219 408.658 164.293C377.158 164.947 377.093 163.519 351.637 162.721Z" fill="#967376"/>
</svg>';

$domca_faq_render_decor_svg = static function () {
	ob_start();
	?>
	<svg
			preserveAspectRatio="none"
			aria-hidden="true"
			viewBox="0 0 1441 134"
			fill="none"
			class="domca-faq__section__item-decor"
	>
		<path
				d="M2 41C2 21.67 17.67 6 37 6H1401C1420.33 6 1436 21.67 1436 41V93C1436 112.33 1420.33 128 1401 128H37C17.6701 128 2 112.33 2 93V41Z"
				fill="white"
		/>
		<path
				d="M1217.46 131.721C1150.09 130.923 1097.06 134.45 1014.96 133.952C932.855 133.453 920.559 131.582 826.528 132.003C732.503 132.424 638.424 131.145 596.557 131.913C554.692 132.682 550.273 130.358 490.821 130.874C431.371 131.39 395.34 131.087 343.347 130.331C291.35 129.576 131.61 128.931 73.5235 129.859C61.5936 130.049 49.3193 130.133 37 130.142C16.804 130.685 -0.648724 111.931 0.21246 93C0.437522 74.2288 0.726787 56.4909 0.948014 41C1.03827 33.2952 3.62948 26.3344 7.26886 21.0609C14.6083 10.497 24.9568 6.73735 32.3276 5.9628C35.519 5.6382 37.0003 5.9001 37 6.02704C37 6.02714 37 6.02724 37 6.02733C36.9955 6.24216 34.7256 6.25822 30.7568 6.97889C18.7372 8.71158 2.58023 21.3406 2.90776 41C3.06188 52.0453 3.25592 64.0062 3.49869 76.672C3.61143 82.5536 3.70275 87.9622 3.77606 93C4.9154 114.99 21.433 125.822 37 126.017C57.9798 126.126 81.7658 126.313 125.926 125.991C213.894 125.349 266.747 124.066 370.252 124.896C473.757 125.725 497.531 122.254 643.638 124.221C789.742 126.188 805.12 122.558 950.717 122.075C1096.32 121.593 1280.11 123.596 1367.87 123.43C1378.49 123.409 1389.55 123.386 1401 123.36C1416.27 123.805 1431.6 109.959 1431.24 93C1431.2 76.2301 1431.17 58.8638 1431.15 41C1431.56 25.4173 1417.47 10.5367 1401 10.9002C1357.72 10.912 1312.32 10.8586 1266.01 10.6803C1141.59 10.2012 987.992 11.4107 850.648 10.5558C713.306 9.701 519.133 8.62133 429.428 7.89786C339.726 7.17441 317.862 7.01123 231.519 7.45328C181.888 7.70739 113.517 7.46787 55.766 6.53336C26.7019 6.06305 33.2878 5.40821 62.5419 5.09489C105.321 4.63673 140.438 4.94281 162.48 4.12443C206.525 2.48886 225.244 1.86143 280.848 2.81339C336.448 3.76524 362.647 1.60201 395.059 1.85099C427.473 2.10009 426.939 3.37605 591.745 2.39298C756.554 1.40987 846.902 1.15902 909.314 0.923011C971.726 0.686997 1102.05 1.7944 1203.76 1.39469C1253.36 1.19981 1327.93 1.18704 1401 1.14926C1422.59 0.62778 1441.46 20.2413 1440.89 41C1440.9 59.0169 1440.93 76.4971 1440.96 93C1441.31 116.665 1419.74 133.821 1401 133.108C1388.76 133.158 1377.76 133.219 1368.34 133.293C1284.99 133.947 1284.81 132.519 1217.46 131.721Z"
				fill="#967376"
		/>
	</svg>
	<?php
	return (string) ob_get_clean();
}

?>

<section
	<?php
	// phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped
	echo $domca_faq_wrapper_attributes;
	?>
>
	<svg
			viewBox="0 0 1920 12"
			fill="none"
			class="<?php echo esc_attr( $domca_faq_base_class . '__separator' ); ?>"
			preserveAspectRatio="none"
			aria-hidden="true"
	>
		<path d="M1075.47 2.27872C1117.85 3.07663 1151.21 -0.449966 1202.86 0.0484999C1254.52 0.546973 1262.25 2.41764 1321.41 1.99674C1380.56 1.57592 1439.75 2.8554 1466.09 2.08683C1492.42 1.31803 1495.2 3.64238 1532.6 3.12614C1570.01 2.60996 1592.67 2.91336 1625.38 3.66886C1658.09 4.42438 1758.59 5.06938 1795.13 4.14127C1831.67 3.21317 1873.35 4.82355 1898.42 5.20548C1906.23 5.32445 1912.37 5.48726 1917.08 5.65665C1919.08 5.72848 1920 5.87873 1920 6.02704C1920 6.02714 1920 6.02724 1920 6.02733C1920 6.212 1918.57 6.39358 1916.01 6.41691C1903.56 6.53017 1884.95 6.829 1862.97 7.49869C1821.99 8.74744 1817.51 7.36752 1762.16 8.00919C1706.82 8.65086 1673.57 9.93371 1608.46 9.10416C1543.34 8.27468 1528.38 11.746 1436.47 9.77872C1344.55 7.81159 1334.88 11.442 1243.28 11.9247C1151.68 12.4074 1036.06 10.4044 980.84 10.5705C925.623 10.7366 851.463 11.1594 773.187 10.6803C694.91 10.2012 598.281 11.4107 511.876 10.5558C425.473 9.701 303.316 8.62133 246.881 7.89786C190.448 7.17441 176.694 7.01123 122.374 7.45328C91.151 7.70739 48.138 7.46787 11.8059 6.53336C-6.47869 6.06305 -2.33538 5.40821 16.0687 5.09489C42.9815 4.63673 65.0739 4.94281 78.9409 4.12443C106.65 2.48886 118.427 1.86143 153.408 2.81339C188.387 3.76524 204.869 1.60201 225.259 1.85099C245.651 2.10009 245.316 3.37605 348.997 2.39298C452.68 1.40987 509.519 1.15902 548.783 0.923011C588.048 0.686997 670.033 1.7944 734.024 1.39469C798.015 0.995004 928.105 1.36132 980.547 0.706947C1032.99 0.0526252 1033.09 1.48082 1075.47 2.27872Z"/>
	</svg>

	<svg
			width="122"
			height="91"
			viewBox="0 0 122 91"
			fill="none"
			class="<?php echo esc_attr( $domca_faq_base_class . '__to-bottom-arrow' ); ?>"
			aria-hidden="true"
	>
		<path d="M6.94151 2.27872C14.5718 3.07663 20.5784 -0.449966 29.8787 0.0485001C39.1788 0.546973 40.5717 2.41764 51.2227 1.99674C61.8732 1.57592 72.5298 2.8554 77.2721 2.08683C82.0143 1.31803 82.5148 3.64238 89.2491 3.12614C95.983 2.60996 100.064 2.91336 105.954 3.66886C108.579 4.00555 113.627 4.32029 119 4.48364L120.462 4.43289L120.516 6C120.313 12.6838 120.344 19.8699 120.859 23.5173C121.787 30.0969 120.176 37.6013 119.795 42.1144C119.676 43.5202 119.513 44.6265 119.343 45.4746C119.272 45.8339 119.121 45.9999 118.973 46C118.973 46 118.973 46 118.973 46C118.788 45.9999 118.606 45.7425 118.583 45.2808C118.47 43.0393 118.171 39.6892 117.501 35.7316C116.253 28.3525 117.632 27.5461 116.991 17.5816C116.711 13.2326 116.309 9.6413 116.013 6L119 8.98685C114.298 9.36827 109.513 9.57165 102.906 9.10416C91.182 8.27468 88.489 11.746 71.9391 9.77872C55.3896 7.81159 53.6477 11.442 37.1556 11.9247C27.2327 12.2152 15.7437 11.6057 6 11.1103L11.1103 6C10.7823 12.4508 10.5043 18.1367 10.5705 22.0968C10.6823 28.7901 10.9105 37.0294 10.9015 46C10.8913 49.6197 11.6797 53.3542 13.2681 56.9699C18.1228 68.5415 33.7374 76.5231 47.698 79.969C52.0924 81.1452 57.2124 82.003 62.5 82.2885C74.2548 83.0901 86.3704 80.2811 92.6723 77.7388C101.72 73.9335 104.175 72.5019 110.181 65.2446C113.512 60.9595 117.1 54.475 118.39 48.0851C118.979 44.8873 119.696 45.5272 119.755 48.9813C119.699 54.0645 117.741 57.8462 117.284 60.5251C116.201 65.8913 115.133 68.5477 109.631 72.5613C104.054 76.3053 102.526 79.5891 98.935 81.3501C95.1889 82.5586 95.402 83.2766 76.5655 88.4138C71.3511 89.5845 66.6506 90.0868 62.5 90.2631C51.4065 90.6638 44.1825 89.0419 38.8785 87.6683C31.4906 85.9133 17.0746 78.1223 9.10902 67.796C5.39906 63.3903 1.07347 55.1127 1.15718 46C1.11759 36.6909 1.06543 27.3223 0.706947 22.1496C0.0807023 13.113 1.36209 12.7074 2.17274 6L2.04465 2.31004L6 2.17274C6.30072 2.20909 6.61411 2.24449 6.94151 2.27872Z"/>
		<path d="M60.8589 49.82C58.9101 49.1869 60.097 45.5489 58.0323 44.419C55.9675 43.2892 54.482 44.4772 52.7668 42.4337C51.0517 40.3905 48.2219 39.6311 47.8388 38.282C47.456 36.9329 45.8401 38.6083 44.9195 37.1273C43.9989 35.6464 43.0374 35.2145 41.4418 34.8314C39.8461 34.4482 36.0416 32.0046 35.4196 30.2374C34.7977 28.4702 32.3403 28.4715 31.2466 28.029C30.906 27.8912 30.5925 27.835 30.3231 27.8256C30.2089 27.8217 30.0794 27.9084 29.9823 28.0204C29.9822 28.0205 29.9822 28.0206 29.9821 28.0207C29.8612 28.1602 29.7904 28.3391 29.8614 28.4316C30.2062 28.8803 30.6366 29.6488 30.9377 30.7959C31.4992 32.935 32.5537 32.0228 33.9959 34.1219C35.4381 36.2209 35.7169 38.1601 38.4516 39.4325C41.1863 40.7049 39.4162 43.7643 43.798 44.9586C48.1797 46.153 46.1276 49.1786 48.894 52.215C51.6605 55.2514 56.8636 57.11 58.613 58.846C58.8246 59.056 59.0431 59.2769 59.2688 59.5064L63.1528 62.0214L65.3465 59.5064C67.2308 58.1191 69.6201 56.4134 71.66 54.0882C73.9805 51.443 78.0245 49.5386 80.3725 46.3725C82.7205 43.2064 86.1244 38.8276 87.5499 36.6349C88.9752 34.4422 89.3313 33.9177 91.4488 32.6675C92.666 31.9488 93.9567 30.5133 94.5674 28.7474C94.8747 27.8587 94.3064 27.4847 93.4818 27.7847C92.2761 28.2234 91.733 29.0991 90.7304 28.8851C88.7266 28.4573 87.9194 28.3266 87.3656 30.0663C86.8118 31.8058 84.8404 30.6518 84.3172 31.4347C83.7941 32.2177 84.6411 33.1721 80.5079 35.4533C76.3747 37.7345 74.2976 39.2027 72.8216 40.1696C71.3457 41.1364 69.3118 44.3645 66.8965 45.9288C64.7542 47.3164 61.2564 50.6762 58.9625 52.1401H65.6529C65.4267 51.8774 65.2338 51.6296 65.0828 51.4008C63.7466 49.3769 62.8076 50.453 60.8589 49.82Z"/>
	</svg>

	<div class="<?php echo esc_attr( $domca_faq_base_class . '__inner dm-wrap' ); ?>">
		<div class="<?php echo esc_attr( $domca_faq_base_class . '__wrap dm-container' ); ?>">
			<?php if ( ! empty( $domca_faq_title ) ) : ?>
				<h2 class="<?php echo esc_attr( $domca_faq_base_class . '__title dm-heading dm-heading-h2' ); ?>">
					<?php echo wp_kses_post( $domca_faq_title ); ?>
				</h2>
			<?php endif; ?>

			<?php if ( ! empty( $domca_faq_items ) ) : ?>
				<div class="<?php echo esc_attr( $domca_faq_base_class . '__items' ); ?>">
					<?php
					$domca_faq_index = 0;
					foreach ( $domca_faq_items as $domca_faq_item ) :
						?>
						<?php
						$domca_faq_item_id    = $domca_faq_item['id'] ?? '';
						$domca_faq_item_title = $domca_faq_item['title'] ?? '';
						$domca_faq_item_text  = $domca_faq_item['text'] ?? '';
						?>
						<div
								class="<?php echo esc_attr( $domca_faq_base_class . '__item' ); ?>"
								data-id="<?php echo esc_attr( $domca_faq_item_id ); ?>"
						>
							<?php echo wp_kses( $domca_faq_item_bg, domca_get_svg_allowed_html() ); ?>
							<?php if ( ! empty( $domca_faq_item_title ) ) : ?>
								<h3 class="<?php echo esc_attr( $domca_faq_base_class . '__item_title' ); ?>">
									<?php echo esc_html( $domca_faq_index + 1 . '. ' . $domca_faq_item_title ); ?>
								</h3>
							<?php endif; ?>
							<?php if ( ! empty( $domca_faq_item_text ) ) : ?>
								<p class="<?php echo esc_attr( $domca_faq_base_class . '__item_text' ); ?>">
									<?php echo esc_html( '– ' . $domca_faq_item_text ); ?>
								</p>
							<?php endif; ?>
						</div>
						<?php
						$domca_faq_index++;
					endforeach;
					?>
				</div>
			<?php endif; ?>
		</div>
	</div>

	<?php if ( ! empty( $domca_faq_items ) ) : ?>
		<div
				id="<?php echo esc_attr( $domca_faq_base_class . '__prebuilt' ); ?>"
				aria-hidden="true"
				hidden
		>
			<?php foreach ( $domca_faq_items as $section ) : ?>
				<?php
				$section_id    = isset( $section['id'] ) ? (string) $section['id'] : '';
				$section_title = $section['title'] ?? '';
				$questions     = is_array( $section['questions'] ?? null ) ? $section['questions'] : array();
				?>
				<section
						class="domca-faq__section-tpl"
						data-id="<?php echo esc_attr( $section_id ); ?>"
				>
					<div class="domca-faq__section__wrap dm-container">
						<h2 class="domca-faq__section__title dm-heading dm-heading-h2">
							<?php echo esc_html( $section_title ); ?>
						</h2>
						<div class="domca-faq__section__items">
							<?php
							$idx = 1;
							foreach ( $questions as $q ) :
								$q_title  = $q['question'] ?? '';
								$q_answer = $q['answer'] ?? '';
								?>
								<div class="domca-faq__section__item">
									<?php
                                    // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped
									echo $domca_faq_render_decor_svg();
									?>
									<div class="domca-faq__section__question">
										<span class="domca-faq__section__question_text">
											<?php echo esc_html( $idx . '. ' . $q_title ); ?>
										</span>
										<svg width="34" height="34" viewBox="0 0 34 34" fill="none">
											<path d="M21.2947 16.5589C20.9552 15.5612 18.9742 16.4895 18.3649 15.469C17.7556 14.4485 18.4052 13.5548 17.2983 12.7952C16.1915 12.0355 15.7855 10.574 15.053 10.4755C14.3203 10.3771 15.2352 9.37449 14.4322 8.99736C13.6292 8.62022 13.3968 8.13746 13.1924 7.30978C12.9879 6.48207 11.6685 4.63056 10.7092 4.43687C9.74981 4.24317 9.75651 2.92137 9.5186 2.36838C9.4445 2.19613 9.41472 2.03204 9.41027 1.88786C9.40842 1.82675 9.45585 1.75023 9.51701 1.68904C9.51705 1.689 9.51709 1.68896 9.51713 1.68892C9.59332 1.61276 9.69076 1.56041 9.74085 1.59125C9.98397 1.74094 10.4008 1.91122 11.0238 1.98176C12.1854 2.11326 11.6869 2.7531 12.8247 3.36154C13.9625 3.96997 15.0162 3.96539 15.7013 5.33488C16.3865 6.70432 18.0543 5.50844 18.693 7.77005C19.3317 10.0316 20.9818 8.68673 22.626 9.9327C24.2702 11.1787 25.2681 13.8291 26.2078 14.6317C26.268 14.6831 26.3298 14.7353 26.3932 14.7884L28.1627 17.2491L26.4315 18.5484C25.6753 19.4892 24.7428 20.7484 23.4222 21.7464C22.0111 22.8127 21.0269 24.8566 19.3322 25.9019C17.6374 26.9473 15.2956 28.4772 14.1191 29.0933C12.9427 29.7093 12.6615 29.8648 12.0083 30.9177C11.6328 31.5229 10.8673 32.1184 9.91272 32.3256C9.43229 32.4299 9.22074 32.0987 9.37326 31.6759C9.5963 31.0577 10.0665 30.8257 9.93634 30.2719C9.67622 29.1652 9.59416 28.7222 10.5353 28.5438C11.4763 28.3653 10.8206 27.2261 11.2405 26.9985C11.6604 26.7709 12.1921 27.2918 13.3805 25.2259C14.5688 23.1599 15.3415 22.1438 15.8489 21.4165C16.3562 20.6892 18.089 19.8169 18.9096 18.6255C19.6795 17.5076 21.6326 15.7253 22.3125 14.594L22.3556 18.8259C22.2822 18.7798 22.2115 18.7391 22.1439 18.7048C21.0467 18.1474 21.6341 17.5566 21.2947 16.5589Z" fill="#967376"/>
										</svg>
									</div>
									<div class="domca-faq__section__answer">
										<p class="domca-faq__section__answer_text">
											<?php echo wp_kses_post( $q_answer ); ?>
										</p>
									</div>
								</div>
								<?php
								$idx++;
							endforeach;
							?>
						</div>
					</div>
				</section>
			<?php endforeach; ?>
		</div>
	<?php endif; ?>

</section>
